<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}"
      layout:fragment="content">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KH Bank 결재 내역</title>
    <style>


        /* 메인 컨텐츠 */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* 페이지 헤더 */
        .page-header {
            background: linear-gradient(135deg, #e4b6ec, #c299dd);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .page-header button{
            margin-left:auto;
        }

        .page-logo {
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 24px;
            color: white;
        }

        .page-title {
            color: white;
            font-size: 28px;
            font-weight: bold;
        }

        /* 테이블 컨테이너 */
        .table-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            border: 2px dashed #ddd;
        }

        /* 테이블 스타일 */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }

        .data-table th {
            background: #f8f9fa;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            color: #666;
            border-bottom: 2px solid #e9ecef;
        }

        .data-table td {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #f0f0f0;
        }

        .data-table tbody tr:hover {
            background: #f8f9fa;
            cursor: pointer;
        }

        /* 순번 컬럼 */
        .data-table .ano {
            background: #f8f9fa;
            font-weight: bold;
            color: #666;
        }

        /* 상태 배지 */
        .status-badge {
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
            display: inline-block;
        }

        .status-waiting {
            background: #fff3cd;
            color: #856404;
        }

        .status-approved {
            background: #d1edff;
            color: #0c5460;
        }

        .status-completed {
            background: #d4edda;
            color: #155724;
        }

        /* 페이지네이션 */
        #pagingArea {
            width: fit-content;
            margin: auto;
        }


        /* 선택된 행 스타일 */
        .data-table tbody tr.selected {
            background: #e3f2fd !important;
        }

        /* 반응형 */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 20px;
            }

            .nav-menu {
                flex-wrap: wrap;
                gap: 15px;
                justify-content: center;
            }

            .nav-item {
                font-size: 12px;
                padding: 8px 16px;
            }

            .container {
                padding: 20px 10px;
            }

            .page-header {
                padding: 20px;
            }

            .page-title {
                font-size: 22px;
            }

            .table-container {
                padding: 20px;
                overflow-x: auto;
            }

            .data-table {
                min-width: 700px;
            }

            .data-table th,
            .data-table td {
                padding: 10px 8px;
                font-size: 13px;
            }
        }

    .pagination {
        display: flex;
        gap: 8px;
        list-style: none;
        padding: 0;
        margin: 0;
        align-items: center; /* 세로 정렬 맞추기 */
    }

    .pagination li {
        display: flex;        /* li 자체도 flex */
        align-items: center;  /* a 태그 수직 중앙 */
    }

    .pagination li a {
        display: inline-flex;        /* flex로 텍스트 중앙 정렬 */
        align-items: center;
        justify-content: center;
        min-width: 36px;             /* 숫자 버튼 크기 일정하게 */
        height: 36px;                /* 높이 고정 */
        padding: 0 12px;
        border: 1px solid #ddd;
        border-radius: 5px;
        background: #fff;
        font-size: 14px;
        color: #333;
        text-decoration: none;
        line-height: 1;              /* 글자 높이 보정 */
        transition: all 0.2s;
    }

    .pagination li a:hover {
        background: #f1f1f1;
    }

    .pagination .active a {
        background: #007bff;
        color: #fff;
        border-color: #007bff;
    }

    .pagination .disabled a {
        pointer-events: none;
        opacity: 0.5;
    }

/* div{border:1px solid red;} */
    #footer {
        width:80%;
        height:200px;
        margin:auto;
        margin-top:50px;
    }
    #footer-1 {
        width:100%;
        height:20%;
        border-top:1px solid lightgray;
        border-bottom:1px solid lightgray;
    }
    #footer-2 {width:100%; height:80%;}
    #footer-1, #footer-2 {padding-left:50px;}
    #footer-1>a {
        text-decoration:none;
        font-weight:600;
        margin:10px;
        line-height:40px;
        color:black;
    }
    #footer-2>p {
        margin:0;
        padding:10px;
        font-size:13px;
    }
    #p2 {text-align:center;}
    </style>
</head>
<body>


<!-- 메인 컨텐츠 -->
<div class="container">
    <!-- 페이지 헤더 -->
    <div class="page-header">
        <div class="page-logo">KH</div>
        <h1 class="page-title">결재 내역</h1>
        <button type="button" id="enrollBtn" class="btn btn-primary">결재신청</button>
    </div>

    <!-- 테이블 컨테이너 -->
    <div class="table-container">
        <table class="data-table">
            <thead>
            <tr>
                <th>결재 번호</th>
                <th>제목</th>
                <th>부서</th>
                <th>작성자</th>
                <th>상태</th>
            </tr>
            </thead>
            <tbody id="tableBody">
            <tr th:each="a : ${list}">
                <td class="ano" th:text="${a.appNo}"></td>
                <td class="title" th:text="${a.appTitle}"></td>
                <td class="department" th:text="${a.deptTitle}"></td>
                <td class="author" th:text="${a.empName}"></td>
                <td>
                    <span th:text="${a.finalStatus}"></span>  <!-- 디버깅용: finalStatus 값 출력 -->
                    <span class="status-badge status-waiting" th:if="${a.finalStatus eq 'U'}" th:text="'처리중'"></span>
                    <span class="status-badge status-approved" th:if="${a.finalStatus eq 'A'}" th:text="'승인'"></span>
                    <span class="status-badge status-completed" th:if="${a.finalStatus eq 'D'}" th:text="'반려'"></span>
                </td>

            </tr>
            </tbody>
        </table>
        <br><br>
        <script>
            $(function(){
                $("#tableBody>tr").click(function(){
                    let ano = $(this).find(".ano").text().trim();
                    location.href="detail.app?ano="+ano;
                })
            })

            $(function(){
                $("#enrollBtn").click(function(){
                    location.href="enrollForm.app";
                })
            })


        </script>

        <!-- 페이지네이션 -->
        <div id="pagingArea">
            <ul class="pagination">

                <li class="page-item" th:classappend="${pi.currentPage == 1} ? 'disabled'">
                    <a th:href="@{|list.app?cpage=${pi.currentPage-1}|}" id="prevBtn">◀ 이전</a>
                </li>
                <li class="page-item"
                    th:each="pageNum : ${#numbers.sequence(pi.startPage, pi.endPage)}"
                    th:classappend="${pageNum == pi.currentPage} ? 'active'">
                    <a class="page-link" th:text="${pageNum}" th:href="@{|list.app?cpage=${pageNum}|}">1~</a>
                </li>
                <li class="page-item" th:classappend="${pi.currentPage == pi.maxPage } ? 'disabled'">
                    <a id="nextBtn" th:href="@{|list.app?cpage=${pi.currentPage +1}|}">다음 ▶</a>
                </li>

            </ul>
        </div>

    </div>
</div>

<script>

    // 테이블 행 클릭 이벤트
    document.querySelectorAll('#tableBody tr').forEach(row => {
        row.addEventListener('click', function() {
            const rowNumber = this.querySelector('.ano').textContent;
            console.log(`${rowNumber}번 항목 클릭`);

            document.querySelectorAll('#tableBody tr').forEach(r => r.classList.remove('selected'));
            this.classList.add('selected');
        });
    });




</script>


</div>
</body>
</html>